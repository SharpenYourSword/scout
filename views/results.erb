<script type="text/javascript">
  $("ul.filters button").prop("disabled", false).removeClass("off").addClass("on")
    .find("span.status").html("on");

  <% types.each do |type, data| %>
    $("ul.filters button.<%= type %>").find("span.results").show().html(
      "<%= data[:count] %> from <%= data[:newest].strftime("%b %d") %>"
    );
  <% end %>
</script>

<% if items.any? %>

  <ul>
    <% current_date = nil %>
    <% items.each do |item| %>
    
      <% if item.date.strftime("%Y-%m-%d") != current_date %>
        <p class="date"><%= long_date item.date %></p>
        <% current_date = item.date.strftime("%Y-%m-%d") %>
      <% end %>
      
      <li class="result <%= item.subscription.subscription_type %>">
        <%= partial :"subscriptions/#{item.subscription.subscription_type}/result", :locals => {:item => item, :keyword => keyword} %>
      </li>
      
    <% end %>
  </ul>
  
<% else %>
  
  <p>
    No results found for this search.
  </p>
  
<% end %>